!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";const t=/([:*])(\w+)/g,e=/\*/g,s="([^/]+)",i="(?:.*)",r="(?:/$|$)",n="",o=!("undefined"==typeof window||!window.history||!window.history.pushState);function a(t,e){"string"!=typeof e?Object.keys(e).forEach(s=>{t.style.setProperty(s,e[s])}):t.style.cssText=e}function c(t,e){Object.keys(e).forEach(s=>{e[s]||""===e[s]?t.setAttribute(s,e[s]):t.removeAttribute(s)})}function l(t,e){Object.keys(e).forEach(s=>{t[s]=e[s]})}function u(t,e){t&&e&&Object.keys(e).forEach(s=>{Array.isArray(e[s])?e[s].forEach(e=>{t.addEventListener(s,e)}):t.addEventListener(s,e[s])})}function h(t,e){t&&e&&Object.keys(e).forEach(s=>{Array.isArray(e[s])?e[s].forEach(e=>{t.removeEventListener(s,e)}):t.removeEventListener(s,e[s])})}function d(t,e){t&&t.children[e]&&t.children[e].remove()}function p(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}function f(t,e,s,...i){if(t){if(s)return t.children&&t.children.forEach(t=>{f(t,e,s,...i)}),void(t.instance&&t.instance[e](...i));t.instance&&t.instance[e](...i),t.children&&t.children.forEach(t=>{f(t,e,s,...i)})}}function v(t){return t instanceof RegExp?t:t.replace(/\/+$/,"").replace(/^\/+/,"^/")}function g(o,a=[]){return a.map(a=>{const{regexp:c,paramNames:l}=function(o){const a=[];let c;c=o instanceof RegExp?o:new RegExp(o.replace(t,function(t,e,i){return a.push(i),s}).replace(e,i)+r,n);return{regexp:c,paramNames:a}}(v(a.path)),u=o.match(c),h=function(t,e){return 0===e.length?null:t?t.slice(1,t.length).reduce((t,s,i)=>(null===t&&(t={}),t[e[i]]=decodeURIComponent(s),t),null):null}(u,l);return!!u&&{match:u,route:a,params:h}}).filter(t=>t)}function m(t,e=[]){return g(function(t,e=!1,s="#"){let i,r=t;const n=t=>t.split(/\?(.*)?$/)[0];return void 0===s&&(s="#"),r=o&&!e?n(t).split(s)[0]:(i=t.split(s)).length>1?n(i[1]):n(i[0])}(t),e)[0]||!1}class b{constructor(t,e=!1){this._value=t,this.forces=e,this.subscribers=[],this.isDestroy=!1,this.firstState=t}get value(){return this._value}destroy(t=!1){this.isDestroy||(t&&(this.subscribers=[]),this.isDestroy=!0)}reInit(){this.isDestroy=!1,this.value=this.firstState}addSubscriber(t){this.isDestroy||this.subscribers.push(t)}removeSubscriber(t){const e=this.subscribers.indexOf(t);e>-1&&this.subscribers.splice(e,1)}set value(t){this.isDestroy||(this._value!==t||this.forces)&&(this._value=t,this.subscribers.length&&this.subscribers.forEach(e=>{e(t)}))}}class y{constructor(t={}){this.obsArr=[],this.values={},this.obs=new b(this.values,!0),this.isDestroyed=!1,Object.keys(t).forEach(e=>{const s=t[e];"object"==typeof s?(this.obsArr.push(s),this.values[e]=s.value,s.addSubscriber(t=>{this.values[e]=t,this.obs.value=this.values})):this.values[e]=s})}get value(){return this.obs}reInit(){this.isDestroyed=!1,this.obs.reInit(),this.obsArr.forEach(t=>{t.reInit()})}destroy(t=!1){this.isDestroyed||(this.obs.destroy(t),this.obsArr.forEach(e=>{e.destroy(t)}),this.isDestroyed=!0)}}const x=Symbol("instance");function C(t){if(!1===t.show)return null;const e="textNode"!==t.tag?document.createElement(t.tag):document.createTextNode("");if(t.domNode=e,null!==t.textValue||void 0!==t.textValue)if("object"==typeof t.textValue){const s=t.textValue;s.addSubscriber(t=>{e.textContent=t}),e.textContent=s.value}else e.textContent=t.textValue;let s,i,r,n;if("textNode"!==t.tag){if(t.classList)if(Array.isArray(t.classList))t.classList.forEach(t=>{e.classList.add(t)});else{s=t.classList;const i=t.classList.value;Object.keys(i.value).forEach(t=>{return i.value[t]?e.classList.add(t):e.classList.remove(t)}),i.addSubscriber(t=>{Object.keys(t).forEach(s=>{return t[s]?e.classList.add(s):e.classList.remove(s)})})}if(t.props)if(t.props instanceof y){r=t.props;const s=t.props.value;l(e,s.value),s.addSubscriber(t=>{l(e,t)})}else l(e,t.props);if(t.styles)if(t.styles instanceof y){const s=(n=t.styles).value;a(e,s.value),s.addSubscriber(t=>{a(e,t)})}else t.styles instanceof b?(n=t.styles,a(e,n.value),n.addSubscriber(t=>{a(e,t)})):a(e,t.styles);if(t.attrs)if(t.attrs instanceof y){i=t.attrs;const s=t.attrs.value;c(e,s.value),s.addSubscriber(t=>{c(e,t)})}else c(e,t.attrs);t.children&&t.children.forEach(t=>{if(!t)return;if(Array.isArray(t))return t.forEach(t=>{if(!t.tag)return void e.appendChild(t);const s=C(Object.assign(t,{parent:e}));s&&e.appendChild(s)}),void(t._parent=e);if(!t.tag)return void e.appendChild(t);const s=C(Object.assign(t,{parent:e}));s&&e.appendChild(s)}),t.listeners&&u(e,t.listeners)}if(t.instance&&(e[x]=t.instance,t.instance.onInit()),"object"==typeof t.show){const o=document.createComment("");return t.show.addSubscriber(a=>{const c=t.parent?t.parent:null;a?c&&(o.parentNode===c&&c.replaceChild(e,o),f(t,"reInit",!1),n&&s.reInit(),s&&s.reInit(),r&&r.reInit(),i&&i.reInit(),"textNode"!==t.tag&&u(e,t.listeners)):c&&("textNode"!==t.tag&&h(e,t.listeners),i&&i.destroy(),r&&r.destroy(),s&&s.destroy(),n&&s.destroy(),f(t,"destroy",!0),e.parentNode===c&&c.replaceChild(o,e))}),t.show.value?e:o}return e}function k(t,e={}){const s=new t(e);return s.template.instance=s,s.template}class w{constructor(){this.reactive={},this.fdObjects={},this.fdStyles={}}onDestroy(){}onInit(){}reInit(){Object.keys(this.fdStyles).forEach(t=>{this.fdStyles[t].reInit()}),Object.keys(this.fdObjects).forEach(t=>{this.fdObjects[t].reInit()}),Object.keys(this.reactive).forEach(t=>{this.reactive[t].reInit()}),this.onInit()}destroy(...t){!0===t[0]&&function t(e){e.listeners&&h(e.domNode,e.listeners),e.children&&e.children.forEach(e=>{!e.instance&&e.tag&&t(e)})}(this.template),Object.keys(this.fdObjects).forEach(e=>{this.fdObjects[e].destroy(...t)}),Object.keys(this.reactive).forEach(e=>{this.reactive[e].destroy(...t)}),Object.keys(this.fdStyles).forEach(e=>{this.fdStyles[e].destroy(...t)}),this.onDestroy()}}function S(t){return E(t)}function E(t,e=!1){return new b(t,e)}const V=(t,e,s={},i,r)=>{let n,o,a=!1;if(r?(o=r,n=t):(a=function(t){const e=typeof t;return null==t||"object"!=e&&"function"!=e}(t),n=a?{id:i,value:t}:t,o=(()=>n)),"function"==typeof e){const r={};return Object.keys(s).forEach(e=>{const i=s[e];r[e]="function"==typeof i?i(a?n.value:t):i}),Object.assign({},e(Object.assign({},r,{index:i})),{fdKey:o(n)})}return Object.assign({},e,{textValue:e.textValue(a?n.value:t),fdKey:o(n)})};function j(t,e,s={},i){if(Array.isArray(t))return t.map((t,i)=>V(t,e,s,i));let r=t.value.map((t,r)=>V(t,e,s,r,i));return t.addSubscriber(t=>{let n=r._parent;if(0===t.length)return r.length&&(r.forEach(t=>{f(t,"destroy",!0,!0)}),p(n)),void((r=t)._parent=n);if(0===r.length)return(r=t.map((t,r)=>V(t,e,s,r,i))).forEach(t=>{n.appendChild(C(t))}),void(r._parent=n);const o=t.map((t,r)=>V(t,e,s,r,i));let a=0;r.forEach((t,e)=>{if(o.length<=e)return f(t,"destroy",!0,!0),d(n,e-a),void(a+=1);o[e].fdKey!==t.fdKey&&(f(t,"destroy",!0,!0),d(n,e-a),a+=1)}),o.forEach((t,e)=>{r.length<=e?n.appendChild(C(t)):r[e].fdKey!==t.fdKey&&function(t,e,s){t&&s&&t.insertBefore(s,t.children[e])}(n,e,C(t))}),(r=o)._parent=n}),r}function _(t){return t.replace(/\/$/,"").split("/").length}function O(t,e){return _(e.path)-_(t.path)}const L=new class extends w{constructor(t){super(),this.baseHref=t,this._arrPaths=[],this._cUrl=E(""),this._cState=E(""),this._currentComp=null,this.template={tag:"div",classList:["router-view"]},this.onPopState=(t=>{this.applyUrl((t.isTrusted?t.state:this.baseHref+t.state).replace(/[\\\\\/]+/g,"/"))}),this.applyUrl=(t=>{const e=m(t,this._arrPaths);if(!e)return;const s=e.route;this._currentComp&&f(this._currentComp,"destroy",!0,!0),this._cState.value=s.path,this._cUrl.value=t,p(this.template.domNode),s.resolver?s.resolver(e.params).then(e=>{this.createComponent(t,s,e)}):this.createComponent(t,s)}),window.addEventListener("popstate",this.onPopState)}setPaths(t={}){Object.keys(t).forEach(e=>{this._arrPaths.push({component:t[e].component,title:t[e].title,path:v((this.baseHref+e).replace(/[\\\\\/]+/g,"/")),resolver:t[e].resolver})}),this._arrPaths.sort(O),this.initRouter()}initRouter(){this.applyUrl(window.location.pathname.replace(/[\\\\\/]+/g,"/"))}createComponent(t,e,s){e.title&&(document.title=e.title),window.history.pushState(this._cUrl.value,document.title,this._cUrl.value);const i=e.component(s);this._currentComp=i,Promise.resolve().then(()=>{this.template.domNode.appendChild(C(i))})}onDestroy(){window.removeEventListener("popstate",this.onPopState)}goToUrl(t){this._cUrl.value!==(this.baseHref+t).replace(/[\\\\\/]+/g,"/")&&dispatchEvent(new PopStateEvent("popstate",{state:t}))}isCurrentRoute(t){const e=m((this.baseHref+t).replace(/[\\\\\/]+/g,"/"),[{path:this._cState.value}]);return!!e&&""!==e.match[0]}getCurrentRoute(){return this._cUrl}getCurrentState(){return this._cState}}(window.location.pathname);function I(t,e,...s){const i=document.querySelector(t);if(!i)throw Error(`FastDOM Bootstrap Error: No container found for selector "${t}"`);i.appendChild(C(e.apply(e,s)))}function N(){return k(T)}class T extends w{constructor(){super(...arguments),this.width=100,this.reactive={counter:E(0)},this.onClick=(()=>{this.counter.value+=1}),this.template={tag:"button",textValue:this.counter,listeners:{click:this.onClick}}}get counter(){return this.reactive.counter}}function A(t){return k(D,t)}class D extends w{constructor(t){super(),this.input=t,this.onClick=(()=>{this.counter.value+=1}),this.template={tag:"button",textValue:this.counter,listeners:{click:this.onClick}}}get counter(){return this.input.counter}onInit(){console.log("init CountersShared")}onDestroy(){console.log("destroy CountersShared")}}class U extends w{constructor(){super(...arguments),this.reactive={src:E("https://www.w3schools.com/html/pic_trulli.jpg"),disabled:S(!1)},this.fdObjects={imgAttrs:new y({src:this.src}),btnAttrs:new y({disabled:this.disabled})},this.onClick=(()=>{this.src.value="https://www.w3schools.com/html/img_girl.jpg"}),this.changeBtnClick=(()=>{this.disabled.value=!this.disabled.value}),this.btnClick=(()=>{alert("hey")}),this.template={tag:"div",children:[{tag:"div",children:[{tag:"span",textValue:"Current state:"},{tag:"span",textValue:this.disabled},{tag:"button",attrs:this.fdObjects.btnAttrs,textValue:"I am button",listeners:{click:this.btnClick}},{tag:"button",textValue:"Click me to change",listeners:{click:this.changeBtnClick}}]},{tag:"button",textValue:"Click me",listeners:{click:this.onClick}},{tag:"span",textValue:this.src},{tag:"div",children:[{tag:"img",attrs:this.fdObjects.imgAttrs}]}]}}get src(){return this.reactive.src}get disabled(){return this.reactive.disabled}}class P extends w{constructor(){super(...arguments),this.reactive={counter:E(0),classOdd:S(!0)},this.fdObjects={classList:new y({odd:this.currentClass})},this.template={tag:"div",classList:this.fdObjects.classList,textValue:this.counter}}get counter(){return this.reactive.counter}get currentClass(){return this.reactive.classOdd}onInit(){const t=()=>{this.timer=window.setTimeout(()=>{this.counter.value+=1,this.currentClass.value=this.counter.value%2==0,t()},1e3)};t()}onDestroy(){clearTimeout(this.timer)}}function R(){return k(P)}function H(){return k($)}class $ extends w{constructor(){super(...arguments),this.reactive={show:S(!0),text:E("Here timer")},this.onClick=(()=>{this.show.value=!this.show.value,this.text.value=this.show.value?"Here timer":"Sorry not timer"}),this.template={tag:"div",children:[{tag:"p",children:[{tag:"span",textValue:"Current value:"},{tag:"span",textValue:this.show}]},{tag:"button",listeners:{click:this.onClick},textValue:"Change state"},{tag:"div",textValue:"You will see me always"},{tag:"div",show:this.show,textValue:"You will sometimes"},{tag:"div",children:[{tag:"strong",textValue:this.text},Object.assign({},R(),{show:this.show})]}]}}get show(){return this.reactive.show}get text(){return this.reactive.text}}function B(){return k(F)}class F extends w{constructor(){super(...arguments),this.reactive={bgFirstColor:E("#"+((1<<24)*Math.random()|0).toString(16)),bgSecondColor:E("background-color: #"+((1<<24)*Math.random()|0).toString(16)+";user-select: none;")},this.fdStyles={divFirstStyle:new y({"background-color":this.reactive.bgFirstColor,"user-select":"none"}),divSecondStyle:this.reactive.bgSecondColor},this.onClick=(()=>{this.reactive.bgFirstColor.value="#"+((1<<24)*Math.random()|0).toString(16)}),this.onClickSecond=(()=>{this.reactive.bgSecondColor.value="background-color: #"+((1<<24)*Math.random()|0).toString(16)+";user-select: none;"}),this.template={tag:"div",children:[{tag:"div",styles:this.fdStyles.divFirstStyle,textValue:"Click me(change styles  object)",listeners:{click:this.onClick}},{tag:"div",styles:this.fdStyles.divSecondStyle,textValue:"Click me(change css string)",listeners:{click:this.onClickSecond}}]}}}function K(t){return k(M,t)}class M extends w{constructor(t){super(),this.input=t,this.onClick=(()=>{this.todoList.value=this.todoList.value.filter((t,e)=>e!==this.index)}),this.template={tag:"div",children:[{tag:"span",textValue:this.textValue},{tag:"button",textValue:"remove",listeners:{click:this.onClick}}]}}get todoList(){return this.input.todoList}get index(){return this.input.index}get textValue(){return this.input.value}}function Y(){return k(q)}class q extends w{constructor(){super(...arguments),this.reactive={inputValue:E(""),todoList:E([])},this.fdObjects={inputValueProp:new y({value:this.inputValue})},this.onInput=(t=>{this.inputValue.value=t.target.value}),this.onClick=(()=>{this.inputValue.value&&(this.todoList.value=[...this.todoList.value,this.inputValue.value],this.inputValue.value="")}),this.inputBlock={tag:"input",attrs:{placeholder:"Write here"},props:this.fdObjects.inputValueProp,listeners:{input:this.onInput}},this.template={tag:"div",children:[{tag:"div",children:[this.inputBlock,{tag:"button",textValue:"add Todo",listeners:{click:this.onClick}}]},{tag:"div",children:[j(this.todoList,K,{todoList:this.todoList,index:(t,e)=>e,value:t=>t})]}]}}get inputValue(){return this.reactive.inputValue}get todoList(){return this.reactive.todoList}}function W(t={}){return k(z,t)}class z extends w{constructor(t){super(),this.inputs=t,this.template={tag:"textNode",textValue:this.inputs.id}}}class G extends w{constructor(){var t;super(...arguments),this.list=[{name:"Home",path:"/",click:()=>{L.goToUrl("/")}},{name:"Timer",path:"/timer",click:()=>{L.goToUrl("/timer")}},{name:"Todo",path:"/todo",click:()=>{L.goToUrl("/todo")}},{name:"If",path:"/if",click:()=>{L.goToUrl("/if")}},{name:"TextNode",path:"/textNode/*",click:()=>{L.goToUrl(`/textNode/${500*Math.random()|0}`)}},{name:"Styles",path:"/styles",click:()=>{L.goToUrl("/styles")}}],this.template={tag:"div",children:[j(this.list,t=>{const e=S(!1);return L.getCurrentRoute().addSubscriber(s=>{e.value=L.isCurrentRoute(t.item.path)}),{tag:"button",textValue:t.item.name,classList:new y({current:e}),listeners:{click:()=>t.item.click()}}},{item:t=>t}),(t={"/":{component:N,title:"Home"},"/textNode/:id":{component:W,title:"TextNode with router param",resolver:t=>Promise.resolve(t)},"/timer":{component:R,title:"Timer"},"/todo":{component:Y,title:"Todo"},"/if":{component:H,title:"If"},"/styles":{component:B,title:"Styles"}},L.setPaths(t),L.template)]}}}function J(t={}){return k(Q,t)}class Q extends w{constructor(t){super(),this.inputs=t,this.template={tag:"div",children:[{tag:"span",textValue:this.counter},A({counter:this.counter})]}}get counter(){return this.inputs.value}onInit(){console.log(`Init ${this.counter.value}`)}onDestroy(){console.log(`Destroy ${this.counter.value}`)}}const X=E([]);setTimeout(()=>{X.value=[1,2,3,4,5],setTimeout(()=>{X.value=[1]},3e3)},3e3);class Z extends w{constructor(){super(...arguments),this.reactive={counter:E(-10)},this.onClick=(()=>{this.counter.value+=1}),this.template={tag:"div",children:[{tag:"button",textValue:"Click me",listeners:{click:this.onClick}},{tag:"textNode",textValue:this.counter}]}}get counter(){return this.reactive.counter}}I("#styles",B),I("#todo",Y),I("#timer",R),I("#counter",N),I("#counter",N);const tt=E(0);I("#counter_input",A,{counter:tt}),I("#counter_input",A,{counter:tt}),I("#counter_input",A,{counter:tt}),I("#simple_if",H),I("#simple_for",function(){return{tag:"div",children:[j([1,2,3,4,5,6,7],{tag:"div",textValue:t=>t})]}}),I("#simple_for_component",function(){return{tag:"div",children:[j([1,2,3,4,5,6,7],N)]}}),I("#simple_for_obs",function(){return{tag:"div",children:[j(X,J,{value:t=>E(t)},t=>t)]}}),I("#attrs",function(){return k(U)}),I("#text_node",function(){return k(Z)}),I("#router",function(){return k(G)})});
//# sourceMappingURL=bundle.js.map
