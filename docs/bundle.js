!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";var t=/([:*])(\w+)/g,e=/\*/g,n="([^/]+)",r="(?:.*)",o="(?:/$|$)",i="",c=!("undefined"==typeof window||!window.history||!window.history.pushState);function a(t,e){"string"!=typeof e?Object.keys(e).forEach(function(n){t.style.setProperty(n,e[n])}):t.style.cssText=e}function u(t,e){Object.keys(e).forEach(function(n){e[n]||""===e[n]?t.setAttribute(n,e[n]):t.removeAttribute(n)})}function s(t,e){Object.keys(e).forEach(function(n){t[n]=e[n]})}function l(t,e){t&&e&&Object.keys(e).forEach(function(n){Array.isArray(e[n])?e[n].forEach(function(e){t.addEventListener(n,e)}):t.addEventListener(n,e[n])})}function f(t,e){t&&e&&Object.keys(e).forEach(function(n){Array.isArray(e[n])?e[n].forEach(function(e){t.removeEventListener(n,e)}):t.removeEventListener(n,e[n])})}function p(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}function d(t,e,n){for(var r,o,i=[],c=3;c<arguments.length;c++)i[c-3]=arguments[c];if(t){if(n)return t.children&&t.children.forEach(function(t){d.apply(void 0,[t,e,n].concat(i))}),void(t.instance&&(r=t.instance)[e].apply(r,i));t.instance&&(o=t.instance)[e].apply(o,i),t.children&&t.children.forEach(function(t){d.apply(void 0,[t,e,n].concat(i))})}}function h(t){return t instanceof RegExp?t:t.replace(/\/+$/,"").replace(/^\/+/,"^/")}function v(c,a){return void 0===a&&(a=[]),a.map(function(a){var u=function(c){var a,u=[];a=c instanceof RegExp?c:new RegExp(c.replace(t,function(t,e,r){return u.push(r),n}).replace(e,r)+o,i);return{regexp:a,paramNames:u}}(h(a.path)),s=u.regexp,l=u.paramNames,f=c.match(s),p=function(t,e){return 0===e.length?null:t?t.slice(1,t.length).reduce(function(t,n,r){return null===t&&(t={}),t[e[r]]=decodeURIComponent(n),t},null):null}(f,l);return!!f&&{match:f,route:a,params:p}}).filter(function(t){return t})}function y(t,e){return void 0===e&&(e=[]),v(function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="#");var r,o=function(t){return t.split(/\?(.*)?$/)[0]};return void 0===n&&(n="#"),c&&!e?o(t).split(n)[0]:(r=t.split(n)).length>1?o(r[1]):o(r[0])}(t),e)[0]||!1}var b=function(){function t(t,e){void 0===e&&(e=!1),this._value=t,this.forces=e,this.subscribers=[],this.isDestroy=!1,this.firstState=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this.isDestroy||(this._value!==t||this.forces)&&(this._value=t,this.subscribers.length&&this.subscribers.forEach(function(e){e(t)}))},enumerable:!0,configurable:!0}),t.prototype.destroy=function(t){void 0===t&&(t=!1),this.isDestroy||(t&&(this.subscribers=[]),this.isDestroy=!0)},t.prototype.reInit=function(){this.isDestroy=!1,this.value=this.firstState},t.prototype.addSubscriber=function(t){this.isDestroy||this.subscribers.push(t)},t.prototype.removeSubscriber=function(t){var e=this.subscribers.indexOf(t);e>-1&&this.subscribers.splice(e,1)},t}(),g=function(){function t(t){void 0===t&&(t={});var e=this;this.obsArr=[],this.values={},this.obs=new b(this.values,!0),this.isDestroyed=!1,Object.keys(t).forEach(function(n){var r=t[n];"object"==typeof r?(e.obsArr.push(r),e.values[n]=r.value,r.addSubscriber(function(t){e.values[n]=t,e.obs.value=e.values})):e.values[n]=r})}return Object.defineProperty(t.prototype,"value",{get:function(){return this.obs},enumerable:!0,configurable:!0}),t.prototype.reInit=function(){this.isDestroyed=!1,this.obs.reInit(),this.obsArr.forEach(function(t){t.reInit()})},t.prototype.destroy=function(t){void 0===t&&(t=!1),this.isDestroyed||(this.obs.destroy(t),this.obsArr.forEach(function(e){e.destroy(t)}),this.isDestroyed=!0)},t}(),m=Symbol("instance");function C(t){if(!1===t.show)return null;var e,n,r,o,i="textNode"!==t.tag?document.createElement(t.tag):document.createTextNode("");if(t.domNode=i,null!==t.textValue||void 0!==t.textValue)if("object"==typeof t.textValue){var c=t.textValue;c.addSubscriber(function(t){i.textContent=t}),i.textContent=c.value}else i.textContent=t.textValue;if("textNode"!==t.tag){if(t.classList)if(Array.isArray(t.classList))t.classList.forEach(function(t){i.classList.add(t)});else{e=t.classList;var p=t.classList.value;Object.keys(p.value).forEach(function(t){return p.value[t]?i.classList.add(t):i.classList.remove(t)}),p.addSubscriber(function(t){Object.keys(t).forEach(function(e){return t[e]?i.classList.add(e):i.classList.remove(e)})})}if(t.props)if(t.props instanceof g){r=t.props;var h=t.props.value;s(i,h.value),h.addSubscriber(function(t){s(i,t)})}else s(i,t.props);if(t.styles)if(t.styles instanceof g){var v=(o=t.styles).value;a(i,v.value),v.addSubscriber(function(t){a(i,t)})}else t.styles instanceof b?(o=t.styles,a(i,o.value),o.addSubscriber(function(t){a(i,t)})):a(i,t.styles);if(t.attrs)if(t.attrs instanceof g){n=t.attrs;var y=t.attrs.value;u(i,y.value),y.addSubscriber(function(t){u(i,t)})}else u(i,t.attrs);t.children&&t.children.forEach(function(t){if(t){if(Array.isArray(t))return t.forEach(function(t){if(t.tag){var e=C(Object.assign(t,{parent:i}));e&&i.appendChild(e)}else i.appendChild(t)}),void(t._parent=i);if(t.tag){var e=C(Object.assign(t,{parent:i}));e&&i.appendChild(e)}else i.appendChild(t)}}),t.listeners&&l(i,t.listeners)}if(t.instance&&(i[m]=t.instance,t.instance.onInit()),"object"==typeof t.show){var k=document.createComment("");return t.show.addSubscriber(function(c){var a=t.parent?t.parent:null;c?a&&(k.parentNode===a&&a.replaceChild(i,k),d(t,"reInit",!1),o&&e.reInit(),e&&e.reInit(),r&&r.reInit(),n&&n.reInit(),"textNode"!==t.tag&&l(i,t.listeners)):a&&("textNode"!==t.tag&&f(i,t.listeners),n&&n.destroy(),r&&r.destroy(),e&&e.destroy(),o&&e.destroy(),d(t,"destroy",!0),i.parentNode===a&&a.replaceChild(k,i))}),t.show.value?i:k}return i}function k(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=new(t.bind.apply(t,[void 0].concat(e)));return r.template.instance=r,r.template}var w=function(){function t(){this.reactive={},this.fdObjects={},this.fdStyles={}}return t.prototype.onDestroy=function(){},t.prototype.onInit=function(){},t.prototype.reInit=function(){var t=this;Object.keys(this.fdStyles).forEach(function(e){t.fdStyles[e].reInit()}),Object.keys(this.fdObjects).forEach(function(e){t.fdObjects[e].reInit()}),Object.keys(this.reactive).forEach(function(e){t.reactive[e].reInit()}),this.onInit()},t.prototype.destroy=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];!0===e[0]&&function t(e){e.listeners&&f(e.domNode,e.listeners),e.children&&e.children.forEach(function(e){!e.instance&&e.tag&&t(e)})}(this.template),Object.keys(this.fdObjects).forEach(function(n){var r;(r=t.fdObjects[n]).destroy.apply(r,e)}),Object.keys(this.reactive).forEach(function(n){var r;(r=t.reactive[n]).destroy.apply(r,e)}),Object.keys(this.fdStyles).forEach(function(n){var r;(r=t.fdStyles[n]).destroy.apply(r,e)}),this.onDestroy()},t}(),x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function S(t,e){function n(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var j=function(){return(j=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function O(t){return _(t)}function _(t,e){return void 0===e&&(e=!1),new b(t,e)}function E(t,e,n,r,o){void 0===n&&(n=[]);var i,c,a,u,s=!1;return o?(c=o,i=t):(u=typeof(a=t),i=(s=null===a||"object"!==u&&"function"!==u)?{id:r,value:t}:t,c=function(){return i}),"function"==typeof e?j({},e.apply(void 0,n.map(function(e){return"function"==typeof e?e(s?i.value:t):e}).concat([r])),{fdKey:c(i)}):j({},e,{textValue:e.textValue(s?i.value:t),fdKey:c(i)})}function V(t,e,n,r){if(void 0===n&&(n=[]),Array.isArray(t))return t.map(function(t,o){return E(t,e,n,o,r)});var o=new Map,i=t.value.map(function(t,i){var c=E(t,e,n,i,r);return o.set(c.fdKey,i),c});return t.addSubscriber(function(t){var c=i._parent;if(0===t.length)return i.length&&(p(c),i.forEach(function(t){d(t,"destroy",!0,!0)})),i=t,o.clear(),void(i._parent=c);if(0===i.length)return(i=t.map(function(t,i){var c=E(t,e,n,i,r);return o.set(c.fdKey,i),c})).forEach(function(t){c.appendChild(C(t))}),void(i._parent=c);var a=t.map(function(t,o){return E(t,e,n,o,r)}),u=Array(i.length).fill(!1),s=a.map(function(t){var e=o.get(t.fdKey);return void 0!==e?[t,e]:[t,-1]});s.forEach(function(t){var e=t[1];e>-1&&(u[e]=!0)}),u.forEach(function(t,e){t||(c.removeChild(i[e].domNode),d(i[e],"destroy",!0,!0))});var l=0;s.forEach(function(t,e){var n=t[0],r=t[1];if(-1===r)return c.appendChild(C(n)),void(l+=1);i[r].domNode!==c.children[e+l]&&(c.insertBefore(i[r].domNode,c.children[e+l]),l+=1)}),o.clear(),a.forEach(function(t,e){t.domNode=c.children[e],o.set(t.fdKey,e)}),(i=a)._parent=c}),i}function L(t){return t.replace(/\/$/,"").split("/").length}function P(t,e){return L(e.path)-L(t.path)}var I=new(function(t){function e(e){var n=t.call(this)||this;return n.baseHref=e,n._arrPaths=[],n._cUrl=_(""),n._cState=_(""),n._currentComp=null,n.template={tag:"div",classList:["router-view"]},n.onPopState=function(t){n.applyUrl((t.isTrusted?t.state:n.baseHref+t.state).replace(/[\\\\\/]+/g,"/"))},n.applyUrl=function(t){var e=y(t,n._arrPaths);if(e){var r=e.route;if(n._currentComp&&d(n._currentComp,"destroy",!0,!0),n._cState.value=r.path,n._cUrl.value=t,p(n.template.domNode),r.resolver)r.resolver(e.params).then(function(e){n.createComponent(t,r,e)});else n.createComponent(t,r)}},window.addEventListener("popstate",n.onPopState),n}return S(e,t),e.prototype.setPaths=function(t){var e=this;void 0===t&&(t={}),Object.keys(t).forEach(function(n){e._arrPaths.push({component:t[n].component,title:t[n].title,path:h((e.baseHref+n).replace(/[\\\\\/]+/g,"/")),resolver:t[n].resolver})}),this._arrPaths.sort(P),this.initRouter()},e.prototype.initRouter=function(){this.applyUrl(window.location.pathname.replace(/[\\\\\/]+/g,"/"))},e.prototype.createComponent=function(t,e,n){var r=this;e.title&&("function"==typeof e.title?document.title=e.title(n):document.title=e.title),window.history.pushState(this._cUrl.value,document.title,this._cUrl.value);var o=e.component(n);this._currentComp=o,Promise.resolve().then(function(){r.template.domNode.appendChild(C(o))})},e.prototype.onDestroy=function(){window.removeEventListener("popstate",this.onPopState)},e.prototype.goToUrl=function(t){this._cUrl.value!==(this.baseHref+t).replace(/[\\\\\/]+/g,"/")&&dispatchEvent(new PopStateEvent("popstate",{state:t}))},e.prototype.isCurrentRoute=function(t){var e=y((this.baseHref+t).replace(/[\\\\\/]+/g,"/"),[{path:this._cState.value}]);return!!e&&""!==e.match[0]},e.prototype.getCurrentRoute=function(){return this._cUrl},e.prototype.getCurrentState=function(){return this._cState},e}(w))(window.location.pathname);function N(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=document.querySelector(t);if(!o)throw Error('FastDOM Bootstrap Error: No container found for selector "'+t+'"');o.appendChild(C(e.call.apply(e,[e].concat(n))))}function A(){return k(T)}var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=100,e.reactive={counter:_(0)},e.onClick=function(){e.counter.value+=1},e.template={tag:"button",textValue:e.counter,listeners:{click:e.onClick}},e}return S(e,t),Object.defineProperty(e.prototype,"counter",{get:function(){return this.reactive.counter},enumerable:!0,configurable:!0}),e}(w);function D(t){return k(U,t)}var U=function(t){function e(e){var n=t.call(this)||this;return n.counter=e,n.onClick=function(){n.counter.value+=1},n.template={tag:"button",textValue:n.counter,listeners:{click:n.onClick}},n}return S(e,t),e.prototype.onInit=function(){console.log("init CountersShared")},e.prototype.onDestroy=function(){console.log("destroy CountersShared")},e}(w);var R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={src:_("https://www.w3schools.com/html/pic_trulli.jpg"),disabled:O(!1)},e.fdObjects={imgAttrs:new g({src:e.src}),btnAttrs:new g({disabled:e.disabled})},e.onClick=function(){e.src.value="https://www.w3schools.com/html/img_girl.jpg"},e.changeBtnClick=function(){e.disabled.value=!e.disabled.value},e.btnClick=function(){alert("hey")},e.template={tag:"div",children:[{tag:"div",children:[{tag:"span",textValue:"Current state:"},{tag:"span",textValue:e.disabled},{tag:"button",attrs:e.fdObjects.btnAttrs,textValue:"I am button",listeners:{click:e.btnClick}},{tag:"button",textValue:"Click me to change",listeners:{click:e.changeBtnClick}}]},{tag:"button",textValue:"Click me",listeners:{click:e.onClick}},{tag:"span",textValue:e.src},{tag:"div",children:[{tag:"img",attrs:e.fdObjects.imgAttrs}]}]},e}return S(e,t),Object.defineProperty(e.prototype,"src",{get:function(){return this.reactive.src},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.reactive.disabled},enumerable:!0,configurable:!0}),e}(w),H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={counter:_(0),classOdd:O(!0)},e.fdObjects={classList:new g({odd:e.currentClass})},e.template={tag:"div",classList:e.fdObjects.classList,textValue:e.counter},e}return S(e,t),Object.defineProperty(e.prototype,"counter",{get:function(){return this.reactive.counter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentClass",{get:function(){return this.reactive.classOdd},enumerable:!0,configurable:!0}),e.prototype.onInit=function(){var t=this,e=function(){t.timer=window.setTimeout(function(){t.counter.value+=1,t.currentClass.value=t.counter.value%2==0,e()},1e3)};e()},e.prototype.onDestroy=function(){clearTimeout(this.timer)},e}(w);function M(){return k(H)}function B(){return k(F)}var F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={show:O(!0),text:_("Here timer")},e.onClick=function(){e.show.value=!e.show.value,e.text.value=e.show.value?"Here timer":"Sorry not timer"},e.template={tag:"div",children:[{tag:"p",children:[{tag:"span",textValue:"Current value:"},{tag:"span",textValue:e.show}]},{tag:"button",listeners:{click:e.onClick},textValue:"Change state"},{tag:"div",textValue:"You will see me always"},{tag:"div",show:e.show,textValue:"You will sometimes"},{tag:"div",children:[{tag:"strong",textValue:e.text},j({},M(),{show:e.show})]}]},e}return S(e,t),Object.defineProperty(e.prototype,"show",{get:function(){return this.reactive.show},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.reactive.text},enumerable:!0,configurable:!0}),e}(w);function K(){return k($)}var $=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={bgFirstColor:_("#"+((1<<24)*Math.random()|0).toString(16)),bgSecondColor:_("background-color: #"+((1<<24)*Math.random()|0).toString(16)+";user-select: none;")},e.fdStyles={divFirstStyle:new g({"background-color":e.reactive.bgFirstColor,"user-select":"none"}),divSecondStyle:e.reactive.bgSecondColor},e.onClick=function(){e.reactive.bgFirstColor.value="#"+((1<<24)*Math.random()|0).toString(16)},e.onClickSecond=function(){e.reactive.bgSecondColor.value="background-color: #"+((1<<24)*Math.random()|0).toString(16)+";user-select: none;"},e.template={tag:"div",children:[{tag:"div",styles:e.fdStyles.divFirstStyle,textValue:"Click me(change styles  object)",listeners:{click:e.onClick}},{tag:"div",styles:e.fdStyles.divSecondStyle,textValue:"Click me(change css string)",listeners:{click:e.onClickSecond}}]},e}return S(e,t),e}(w);function Y(t,e){return k(q,t,e)}var q=function(t){function e(e,n){var r=t.call(this)||this;return r.todoList=e,r.value=n,r.onClick=function(){r.todoList.value=r.todoList.value.filter(function(t){return t!==r.value})},r.template={tag:"div",children:[{tag:"span",textValue:r.value.label},{tag:"button",textValue:"remove",listeners:{click:r.onClick}}]},r}return S(e,t),e}(w);function W(){return k(z)}var z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={inputValue:_(""),todoList:_([])},e.fdObjects={inputValueProp:new g({value:e.inputValue})},e.onInput=function(t){e.inputValue.value=t.target.value},e.onClick=function(){e.inputValue.value&&(e.todoList.value=e.todoList.value.concat([{label:e.inputValue.value}]),e.inputValue.value="")},e.inputBlock={tag:"input",attrs:{placeholder:"Write here"},props:e.fdObjects.inputValueProp,listeners:{input:e.onInput}},e.template={tag:"div",children:[{tag:"div",children:[e.inputBlock,{tag:"button",textValue:"add Todo",listeners:{click:e.onClick}}]},{tag:"div",children:[V(e.todoList,Y,[e.todoList,function(t){return t}])]}]},e}return S(e,t),Object.defineProperty(e.prototype,"inputValue",{get:function(){return this.reactive.inputValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"todoList",{get:function(){return this.reactive.todoList},enumerable:!0,configurable:!0}),e}(w);function G(t){return void 0===t&&(t={}),k(J,t)}var J=function(t){function e(e){var n=t.call(this)||this;return n.inputs=e,n.template={tag:"textNode",textValue:n.inputs.id},n}return S(e,t),e}(w),Q=function(t){function e(){var e,n=null!==t&&t.apply(this,arguments)||this;return n.list=[{name:"Home",path:"/",click:function(){I.goToUrl("/")}},{name:"Timer",path:"/timer",click:function(){I.goToUrl("/timer")}},{name:"Todo",path:"/todo",click:function(){I.goToUrl("/todo")}},{name:"If",path:"/if",click:function(){I.goToUrl("/if")}},{name:"TextNode",path:"/textNode/*",click:function(){I.goToUrl("/textNode/"+(500*Math.random()|0))}},{name:"Styles",path:"/styles",click:function(){I.goToUrl("/styles")}}],n.template={tag:"div",children:[V(n.list,function(t){var e=O(!1);return I.getCurrentRoute().addSubscriber(function(n){e.value=I.isCurrentRoute(t.path)}),{tag:"button",textValue:t.name,classList:new g({current:e}),listeners:{click:function(){return t.click()}}}},[function(t){return t}]),(e={"/":{component:A,title:"Home"},"/textNode/:id":{component:G,resolver:function(t){return Promise.resolve(j({},t,{title:"Route title "+t.id}))},title:function(t){return"TextNode with "+t.title}},"/timer":{component:M,title:"Timer"},"/todo":{component:W,title:"Todo"},"/if":{component:B,title:"If"},"/styles":{component:K,title:"Styles"}},I.setPaths(e),I.template)]},n}return S(e,t),e}(w);function X(t){return k(Z,t)}var Z=function(t){function e(e){var n=t.call(this)||this;return n.counter=e,n.template={tag:"div",children:[{tag:"span",textValue:n.counter},D(n.counter)]},n}return S(e,t),e.prototype.onInit=function(){console.log("Init "+this.counter.value)},e.prototype.onDestroy=function(){console.log("Destroy "+this.counter.value)},e}(w),tt=_([]);setTimeout(function(){tt.value=[1,2,3,4,5],setTimeout(function(){tt.value=[1]},3e3)},3e3);var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reactive={counter:_(-10)},e.onClick=function(){e.counter.value+=1},e.template={tag:"div",children:[{tag:"button",textValue:"Click me",listeners:{click:e.onClick}},{tag:"textNode",textValue:e.counter}]},e}return S(e,t),Object.defineProperty(e.prototype,"counter",{get:function(){return this.reactive.counter},enumerable:!0,configurable:!0}),e}(w);N("#styles",K),N("#todo",W),N("#timer",M),N("#counter",A),N("#counter",A);var nt=_(0);N("#counter_input",D,nt),N("#counter_input",D,nt),N("#counter_input",D,nt),N("#simple_if",B),N("#simple_for",function(){return{tag:"div",children:[V([1,2,3,4,5,6,7],{tag:"div",textValue:function(t){return t}})]}}),N("#simple_for_component",function(){return{tag:"div",children:[V([1,2,3,4,5,6,7],A)]}}),N("#simple_for_obs",function(){return{tag:"div",children:[V(tt,X,[function(t){return _(t)}],function(t){return t})]}}),N("#attrs",function(){return k(R)}),N("#text_node",function(){return k(et)}),N("#router",function(){return k(Q)})});
//# sourceMappingURL=bundle.js.map
